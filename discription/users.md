# Пользователи и роли

Модуль профиля объединяет управление учётной записью, назначенными ролями и уведомлениями.

## Доступ и авторизация
- При загрузке `user.php` по умолчанию открывается профиль текущего пользователя, но при наличии прав `BUSINESS:USERS:VIEW:INDIVIDUAL_USER` или серверного `USERS:EDIT` можно просматривать другие аккаунты. 【F:src/user.php†L5-L24】
- В шапке профиля отображаются доступные внешние провайдеры входа (Google, Microsoft), что помогает быстро подключить SSO. 【F:src/user.php†L7-L8】
- Если отсутствует календарный ключ, система генерирует случайный хэш длиной 50 символов и сохраняет его в базе для интеграции с внешними календарями. 【F:src/user.php†L26-L37】

## Проектные роли и назначения
- Раздел `crewAssignments` показывает все активные роли пользователя на проектах с датами, клиентами и статусами, фильтруя проекты, где активы уже выпущены. 【F:src/user.php†L41-L52】
- Отдельный блок `projectManagement` содержит проекты, в которых пользователь назначен менеджером, с указанием дат использования и статусов. 【F:src/user.php†L53-L65】
- История должностей загружается из `userPositions`, включая сроки действия и связанные должности. Счётчик `currentPositions` показывает, может ли пользователь входить в систему. 【F:src/user.php†L66-L76】

## Управление позициями и уведомлениями
- Для переназначения ролей администраторы получают полный список доступных позиций, отсортированных по рангу и названию. 【F:src/user.php†L77-L79】
- Персональные настройки уведомлений извлекаются через `notificationSettings`, а список типов уведомлений берётся из подключаемого справочника `NOTIFICATIONTYPES`. 【F:src/user.php†L81-L86】

## Практические советы
1. Используйте автоматическую генерацию календарного хэша, чтобы сотрудник мог подписаться на персональный календарь проекта и экипажа. 【F:src/user.php†L26-L37】
2. Регулярно проверяйте раздел `currentPositions`: если значение равно нулю, пользователь потеряет доступ после завершения текущих назначений. 【F:src/user.php†L72-L76】
3. Настраивайте уведомления через список типов, чтобы сотрудник получал только релевантные события (обслуживание, новые проекты и т. д.). 【F:src/user.php†L81-L86】
